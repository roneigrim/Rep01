
1
down vote
favorite
1
Could you please explain why there would be messages pending in the queue SYSTEM.CHLAUTH.DATA.QUEUE. There are 3 messages in the queue now. what if these messages are deleted. Will there be any issues if we delete these messages. Are those information messages about the channel authentication records? Please suggest a resolution.

ibm-mq
shareimprove this question
asked Feb 5 at 13:37

Rinak
678
@Achilles Would it be a problem if the messages stay in the queue. If possible can you please provide an evidence – Rinak Feb 5 at 15:02
@JoshMc We have monitoring in place for all the queues including the system queues, so we get notified when there are messages pending in any of the local queues/system queues. I haven't put any messages in the queue. But concerned why there are messages in this queue though we have Channel Authentication disabled on queue manager level ' CHLAUTH(DISABLED) ' – Rinak Feb 5 at 15:20 
It would be recommended to only monitor specific SYSTEM queues that provide value such as SYSTEM.CLUSTER.TRANSMIT.QUEUE if you are using clustering, or SYSTEM.MANAGED.* queues if you are using Managed Pub/Sub. – JoshMc Feb 5 at 15:28
add a comment
1 Answer
active oldest votes
up vote
2
down vote
accepted
The IBM MQ v7.5 Knowledge Center page "Troubleshooting channel authentication records addresses the topic of what the SYSTEM.CHLAUTH.DATA.QUEUE is used for.

Behaviour of SET CHLAUTH command over queue manager restart

If the SYSTEM.CHLAUTH.DATA.QUEUE, has been deleted or altered in a way that it is no longer accessible i.e. PUT(DISABLED), the SET CHLAUTH command will only be partially successful. In this instance, SET CHLAUTH will update the in-memory cache, but will fail when hardening.

This means that although the rule put in place by the SET CHLAUTH command may be operable initially, the effect of the command will not persist over a queue manager restart. The user should investigate, ensuring the queue is accessible and then reissue the command (using ACTION(REPLACE) ) before cycling the queue manager.

If the SYSTEM.CHLAUTH.DATA.QUEUE remains inaccessible at queue manager startup, the cache of saved rules cannot be loaded and all channels will be blocked until the queue and rules become accessible.

In Summary, each time you add, change, or delete a CHLAUTH rule, the queue manager updates does two things:

It updates the in-memory cache (running configuration)
It hardens the configuration by adding, updating, or removing messages in the SYSTEM.CHLAUTH.DATA.QUEUE. This is so that the running configuration will be available when the queue manager is restarted.
When the queue manager is restarted, it reads the messages from the SYSTEM.CHLAUTH.DATA.QUEUE to initially populate the in-memory cache (running configuration) with previously existing rules.

If you were to delete the messages from this queue and restart your queue manager you would find there would be no CHLAUTH records set.

A similar queue exists called SYSTEM.AUTH.DATA.QUEUE which holds the queue manager's OAM (authorization) rules. One difference between the CHLAUTH queue and this queue is that the AUTH queue is opened by an internal MQ process with MQOO_INPUT_EXCLUSIVE which means you can not open the queue at all.

Note that CHLAUTH was added at MQ v7.1. If a queue manager is created new under 7.1 or higher CHLAUTH will be ENABLED by default. If a queue manager is upgraded to MQ v7.1 or higher from a version prior to 7.1 then CHLAUTH will be DISABLED by default. No matter if it a new or upgraded queue manager, or if CHLAUTH is ENABLED or DISABLED, there are three default rules that will be in place (listed below).

BLOCKUSER rule to deny any MQADMIN user on all SRVCONN channels.
ADDRESSMAP rule to deny usage of any channel that starts with SYSTEM.* from any IP address.
ADDRESSMAP rule to allow connections to SYSTEM.ADMIN.SVRCONN from any IP address. Rule #1's restriction still applies.
The three default rules are likely directly related to the three messages you observed in the queue. In general leaving CHLAUTH ENABLED with the default rules is a good thing. I normally get rid of #3 because I do not have a channel with this name. You noted that CHLAUTH is disabled, if you have no intention of using this feature you could use saveqmgr or dmpmqcfg to dump MQSC commands to recreate these three default rules and then delete those three rules, this will remove the three messages on the SYSTEM.CHLAUTH.DATA.QUEUE.

If in the future you come to your senses and turn CHLAUTH back on, you can restore the rules you deleted with the backup created.

https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.pro.doc/q004080_.htm